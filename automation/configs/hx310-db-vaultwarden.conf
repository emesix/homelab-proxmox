# Vaultwarden LXC Configuration for HX310-DB (breintrein)
# Deploy on: pve-hx310-db (192.168.10.12 staging)
# Service: kluisbaas (Vaultwarden password manager)
# PRIORITY: HIGH - Deploy immediately after PostgreSQL

# Container Identity
export var_ctid="101"                          # CT ID 101 for Vaultwarden
export var_hostname="kluisbaas"                # Container hostname

# Resource Allocation
export var_cpu="1"                             # 1 CPU core (sufficient for password manager)
export var_ram="2048"                          # 2GB RAM (adequate for Vaultwarden)
export var_disk="20"                           # 20GB disk space

# Storage - Use rpool for fast access
export var_storage="local-lvm"                 # Or "rpool/vaultwarden" if dataset exists

# Container Type - Privileged for Docker-in-LXC
export var_unprivileged="0"                    # Privileged container (required for Docker)

# OS Configuration
export var_os="debian"                         # Debian base
export var_version="12"                        # Debian 12 Bookworm

# Network Configuration - STAGING
export var_brg="vmbr0"                         # Network bridge
export var_net="ip=192.168.10.21/16,gw=192.168.10.1"  # Staging IP

# SSH Access
export var_ssh="yes"                           # Enable SSH for management

# Advanced Options
export var_verbose="no"                        # Verbose output
export var_tags="password-manager;vaultwarden;security;tier0;breintrein"

# Vaultwarden deployment notes:
# - Compiles from Rust source (takes 20-30 minutes)
# - Requires privileged container for Docker
# - After deployment:
#   1. Access via https://192.168.10.21:8000
#   2. Create admin account IMMEDIATELY
#   3. Set ADMIN_TOKEN in /opt/vaultwarden/.env
#   4. Disable public signups after account creation
#   5. Store PostgreSQL credentials from pg-brein
#   6. Export vault backup and store securely
# - Database: Can use PostgreSQL instead of SQLite
#   Connection: postgresql://vaultwarden:<password>@192.168.10.20:5432/vaultwarden
